![image-20211103140356927](D:\BUAA_Numerical_Analysis\设计文档\第三次作业.assets\image-20211103140356927.png)



![image-20211103140335740](D:\BUAA_Numerical_Analysis\设计文档\第三次作业.assets\image-20211103140335740.png)



<h1><center>数值分析第三次大作业</center></h1>















<center>院（系）名称：计算机学院</center>

<center>学 生 学 号：ZY2106339</center>

<center>学 生 姓 名：陈 铭 煊</center>

<center>授 课 教 师：谢 家 新</center>



<center>2021 年 12 月</center>



<div STYLE="page-break-after: always;"></div>

## 1. 设计方案

### 题目描述

  本次作业出自《数值分析（第四版）》（颜庆津 编著）计算实习说明书第八题：

  关于$x,y,t,u,v,w$的方程组（A.3）
$$
\left\{\begin{array}{l}0.5 \cos t+u+v+w-x=2.67 \\ t+0.5 \sin u+v+w-y=1.07 \\ 0.5 t+u+\cos v+w-x=3.74 \\ t+0.5 u+v+\sin w-y=0.79\end{array}\tag{A.3}\right.
$$
  以及关于$z,t,u$的二维数表（见表A-1）确定了一个二元函数$z=f(x,y)$。

| $t\ \ u\\z$ | 0     | 0.4   | 0.8   | 1.2    | 1.6   | 2     |
| ----------- | ----- | ----- | ----- | ------ | ----- | ----- |
| **0**       | -0.5  | -0.34 | 0.14  | 0.94   | 2.06  | 3.5   |
| **0.2**     | -0.42 | -0.5  | -0.26 | 0.3    | 1.18  | 2.38  |
| **0.4**     | -0.18 | -0.5  | -0.5  | -0.18  | 0.46  | 1.42  |
| **0.6**     | 0.22  | -0.34 | -0.58 | -0.5   | -0.1  | 0.62  |
| **0.8**     | 0.78  | -0.02 | -0.5  | -0..66 | -0.5  | -0.02 |
| **1.0**     | 1.5   | 0.46  | -0.26 | -0.66  | -0.74 | -0.5  |

1. 试用数值方法求出$f(x,y)$在区域$D=\{(x,y)|0\le x\le 0.8,\ 0.5\le y\le 1.5\}$上的近似表达式
   $$
   p(x,y)=\sum_{r=0}^k\sum_{s=0}^k c_{rs}x^ry^s
   $$
   要求$p(x,y)$以最小的$k$值达到以下的精度
   $$
   \sigma=\sum_{i=0}^{10} \sum_{j=0}^{20}\left[f\left(x_{i}, y_{j}\right)-p\left(x_{i}, y_{j}\right)\right]^{2} \leqslant 10^{-7}
   $$
   其中$x_{i}=0.08 i, y_{j}=0.5+0.05 j$ 。

2. 计算$f\left(x_{i}^{*}, y_{j}^{*}\right), p\left(x_{i}^{*}, y_{j}^{*}\right) \quad(i=1,2, \cdots, 8 ; j=1,2, \cdots, 5)$的值，以观察$p(x,y)$逼近$f(x,y)$的效果，其中$x_i^*=0.1i,\ y_j^*=0.5+0.2j$。

####   说明

1. 用迭代方法求解非线性方程组时，要求近似解向量$x^{(k)}$满足以下的精度：
   $$
   \frac{\left\|x^{(k)}-x^{(k-1)}\right\|_{\infty}}{\left\|x^{(k)}\right\|_{\infty}} \leqslant 10^{-12}
   $$

2. 做二元插值时，要求使用分片二次代数插值。

3. 要由程序自动确定最小的$k$值。

4. 打印以下内容：

   (1) 全部源程序；

   (2) 数表：$(x_i,y_j,f(x_i,y_j))\ (i=0,1,...,10;j=0,1,...,20)$；

   (3) 选择过程的$k$和$\sigma$值；

   (4) 达到精度要求时的$k$和$\sigma$值以及$p(x,y)$中的系数$c_{rs}(r=0,1,...,k;\ s=0,1,...,k)$；

   (5) 数表：$\left(x_{i}^{*}, y_{j}^{*}, f\left(x_{i}^{*}, y_{j}^{*}\right), p\left(x_{i}^{*}, y_{j}^{*}\right)\right)\quad(i=1,2, \cdots, 8 ;\ j=1,2, \cdots, 5)$。

5. 采用f型输出$x_{i}, y_{j}, x_{i}^{*}, y_{j}^{*}$的准确值，其余实型数采用e型输出并且至少显示12位有效数字。

### 算法分析

#### 总体思路

  首先题目中并没有给出$f(x,y)$的具体形式。由于$x,y$确定为$x_i,y_j$时，通过解四元非线性方程组，得到$t,u$也确定，因此我们转而需要求出$z=f(x,y)=\varphi(t,u)$，题目中也没有给出$\varphi$，而是给出了一个$z,t,u$的数表，按照说明，我们需要用分片二次代数插值来确定$\varphi$，进而确定$f(x,y)$，求出$f(x_i,y_j)$。

  求出所有$f(x_i,y_j)$之后，我们需要进行近似拟合，这里我们采用最小二乘曲面拟合方法，详见书P141-P143页。另外注意我们选取幂函数为基函数，这样可以直接求出$c_{rs}$。

  通过从小到大枚举多项式次数$k$，误差逐渐减小，可以找到最小的满足要求的$k$。

#### 牛顿法求解固定$x,y$时的$t,u$

  固定$x,y$，则方程组（A.3）变成了四元四次非线性方程组，可以用牛顿迭代法求解。首先将项移动到方程左侧，接着构造$F(t,u,v,w)$，这是一个方程向量，每一元素是一个非线性函数，包含关于$t,u,v,w$的非线性项和常数项。接着求出偏导数矩阵$F'(t,u,v,w)$，这是一个$4\times 4$的矩阵，每个元素是一个非线性函数。

  迭代公式为：
$$
\left(\begin{array}{c}t^{(k+1)} \\ u^{(k+1)} \\ v^{(k+1)} \\ w^{(k+1)}\end{array}\right)=\left(\begin{array}{c}t^{(k)} \\ u^{(k)} \\ v^{(k)} \\ w^{(k)}\end{array}\right)+\left(\begin{array}{c}\Delta t^{(k)} \\ \Delta u^{(k)} \\ \Delta v^{(k)} \\ \Delta w^{(k)}\end{array}\right), k=0,1,2, \cdots, n
$$
  其中$(\Delta t^{(k)},\Delta u^{(k)},\Delta v^{(k)}, \Delta w^{(k)})^T$为以下方程组的解
$$
F^{\prime}\left(t^{(k)}, u^{(k)}, v^{(k)}, w^{(k)}\right)\left(\begin{array}{c}\Delta t^{(k)} \\ \Delta u^{(k)} \\ \Delta v^{(k)} \\ \Delta w^{(k)}\end{array}\right)=-F\left(t^{(k)}, u^{(k)}, v^{(k)}, w^{(k)}\right)
$$
  这里需要实现线性方程组的求解，可以使用列主元高斯消去法。

  由题目要求，取相对范数误差小于$10^{-12}$为终止条件。

  因为从表中观察到$t,u$取值基本在$[0,2]$上，因此，选取$(1,1,1,1)$为迭代初始值，能比较有效地减少迭代次数，之后的观察也确实如此。

#### 分片二元双二次插值求解$\varphi(t,u)$

  这里我们对原数表，应用分片二元双二次插值法。令
$$
t_{m}=0.2 m, u_{n}=0.4 n\ (m=0,1, \ldots .5 ; n=0,1, \ldots .5)
$$
  对于给定的$t,u$，找到最接近的三个插值点$t_{i-1},t_i,t_{i+1}$和$u_{j-1},u_{j},u_{j+1}$，即
$$
i=\left\{\begin{array}{l} \lfloor\frac{t}{0.2}\rceil\ (0.2\le t\le 0.8)\\
1\ (t<0.2)\\
4\ (t>0.8)
\end{array}\right.
$$

$$
j=\left\{\begin{array}{l} \lfloor\frac{u}{0.4}\rceil\ (0.4\le u\le 1.6)\\
1\ (u<0.4)\\
4\ (u>1.6)
\end{array}\right.
$$

  相应的插值多项式为
$$
\varphi(t,u)=\sum_{k=i-1}^{i+1}\sum_{r=j-1}^{j+1}l_k(t)l_r(u)\varphi(t_{k},u_{r})
$$
  其中
$$
l_k(t)=\prod_{q=i-1,q\neq k}^{i+1}\frac{t-t_q}{t_k-t_q}\ (k=i-1,i,i+1)\\
l_r(u)=\prod_{q=j-1,q\neq k}^{j+1}\frac{u-u_q}{u_k-u_q}\ (k=j-1,j,j+1)
$$
  得到$\varphi(t,u)$的表达式之后，代入即可得到值。实际操作时一般是根据$t,u$的值进行现场插值。此时即可求出

#### 乘积型最小二乘曲面拟合

  使用幂函数作为基矩阵，有基矩阵如下：
$$
B=\left(\begin{array}{ccc}x_{0}^{0} & \cdots & x_{0}^{k} \\ \vdots & \ddots & \vdots \\ x_{i}^{0} & \cdots & x_{i}^{k}\end{array}\right), \quad G=\left(\begin{array}{ccc}y_{0}^{0} & \cdots & y_{0}^{k} \\ \vdots & \ddots & \vdots \\ y_{j}^{0} & \cdots & y_{j}^{k}\end{array}\right)
$$
  数表矩阵为：
$$
U=\left(\begin{array}{ccc}f\left(x_{0}, y_{0}\right) & \cdots & f\left(x_{0}, y_{j}\right) \\ \vdots & \ddots & \vdots \\ f\left(x_{i}, y_{0}\right) & \cdots & f\left(x_{i}, y_{j}\right)\end{array}\right)
$$
  根据书P142，系数矩阵表达式为：
$$
C=\left(B^{T} B\right)^{-1} B^{T} U G\left(G^{T} G\right)^{-1}
$$
  于是我们首先求解方程：
$$
(B^T B)D=B^TUG
$$
  得到矩阵$D$后求解
$$
(G^T G)^T C^T=D^T
$$
  即可得到$C$，这里可以继续使用之前的列主元高斯消去法，只是常量从向量变成了矩阵。

#### 求解给定点的$f$值与$p$值

  $f(x_i^*,y_j^*)$的计算和$f(x_i,y_j)$相同。将$(x_i^*,y_j^*)$代入原方程组，求解相应$(t_{ij}^*,u_{ij}^*)$，进行分片双二次插值求得$f(x_i^*,y_j^*)$。$p(x_i^*,y_j^*)$只需代入上一步求得的二元多项式即可。

## 2. 源程序代码

### 简介

  本程序采用C++17标准编写，模块清晰，通用性强，效率优秀，使用CMake（version ≥ 3.16）组织代码，使用MSVC 8.1或GCC 9.3.0编译器均可编译通过。文件结构如下：

```
.
│  CMakeLists.txt
│  InterpolationUtil.cpp
│  InterpolationUtil.h
│  LinearEqUtil.cpp
│  LinearEqUtil.h
│  main.cpp
│  Matrix.cpp
│  Matrix.h
│  NonLinearEqUtil.cpp
│  NonLinearEqUtil.h
│  NonLinFormula.cpp
│  NonLinFormula.h
│  NonLinItemMatrix.cpp
│  NonLinItemMatrix.h
│  NonSqMatrix.cpp
│  NonSqMatrix.h
│  Vector.cpp
│  Vector.h
│  ZeroRangeGuard.h
```

  对于向量和矩阵的实现，分别在`Vector`和`Matrix`类中。另外因为曲面拟合的需要，实现了`Matrix`的友元类`NonSqMatrix`，用于支持非方阵的矩阵运算，并且能在长宽相等时高效转换为`Matrix`。

  对于线性方程组的求解，实现在类`LinearEqUtil`中，在以往的基础上将单个常向量扩展为多个，这样就可以一次性求解系数矩阵相同的多个线性方程组，也即处理方程右侧为矩阵的情况。

  我们实现了`NonLinFormula`和`NonLinItemMatrix`类，前者为代数式运算提供方便。后者主要用于牛顿迭代法，储存$F$和$F'$。这两个类避免了对算式的硬编码，提高了程序的通用能力。

  对于牛顿迭代法，被简洁地实现在了`NonLinearEqUtil::solveByNewtonMethod`中。

  对于分片二元双二次插值算法求给定点的值，实现在了`InterpolationUtil::twoDimQuadLagrangeInterpolation`函数中。其步骤均以向量化的形式描述。

  对于乘积型最小二乘曲面拟合算法，因为步骤简单，实现在了`main.cpp`中。在一个循环中不断尝试增长次数$k$，直到达到误差要求为止，最后输出拟合的系数。

### 内容

<div STYLE="page-break-after: always;"></div>

​     

<div STYLE="page-break-after: always;"></div>

## 3. 上机计算结果

  以某次运行为例，得到结果：

  数表$(x_i,y_i,f(x_i,y_i))$

```
.00E+00 .500E+00        .446504018481E+00
.00E+00 .550E+00        .324683262928E+00
.00E+00 .600E+00        .210159686683E+00
.00E+00 .650E+00        .103043608316E+00
.00E+00 .700E+00        .340189556268E-02
.00E+00 .750E+00        -.887358136380E-01
.00E+00 .800E+00        -.173371632750E+00
.00E+00 .850E+00        -.250534611467E+00
.00E+00 .900E+00        -.320276506388E+00
.00E+00 .950E+00        -.382668066110E+00
.00E+00 .100E+01        -.437795766738E+00
.00E+00 .105E+01        -.485758941444E+00
.00E+00 .110E+01        -.526667254884E+00
.00E+00 .115E+01        -.560638479797E+00
.00E+00 .120E+01        -.587796538768E+00
.00E+00 .125E+01        -.608269779090E+00
.00E+00 .130E+01        -.622189452876E+00
.00E+00 .135E+01        -.629688378186E+00
.00E+00 .140E+01        -.630899760003E+00
.00E+00 .145E+01        -.625956152545E+00
.00E+00 .150E+01        -.614988546609E+00
.80E-01 .500E+00        .638015226511E+00
.80E-01 .550E+00        .506611755147E+00
.80E-01 .600E+00        .382176369277E+00
.80E-01 .650E+00        .264863491154E+00
.80E-01 .700E+00        .154780200285E+00
.80E-01 .750E+00        .519926834909E-01
.80E-01 .800E+00        -.434680402049E-01
.80E-01 .850E+00        -.131601056789E+00
.80E-01 .900E+00        -.212431088309E+00
.80E-01 .950E+00        -.286004551058E+00
.80E-01 .100E+01        -.352386078979E+00
.80E-01 .105E+01        -.411655456522E+00
.80E-01 .110E+01        -.463904911519E+00
.80E-01 .115E+01        -.509236724701E+00
.80E-01 .120E+01        -.547761117962E+00
.80E-01 .125E+01        -.579594388339E+00
.80E-01 .130E+01        -.604857258890E+00
.80E-01 .135E+01        -.623673421332E+00
.80E-01 .140E+01        -.636168248413E+00
.80E-01 .145E+01        -.642467656690E+00
.80E-01 .150E+01        -.642697102700E+00
.16E+00 .500E+00        .840081395767E+00
.16E+00 .550E+00        .699764165673E+00
.16E+00 .600E+00        .566061442352E+00
.16E+00 .650E+00        .439171608118E+00
.16E+00 .700E+00        .319242138041E+00
.16E+00 .750E+00        .206376192387E+00
.16E+00 .800E+00        .100638523891E+00
.16E+00 .850E+00        .206074006784E-02
.16E+00 .900E+00        -.893540247670E-01
.16E+00 .950E+00        -.173626968865E+00
.16E+00 .100E+01        -.250799956160E+00
.16E+00 .105E+01        -.320932269445E+00
.16E+00 .110E+01        -.384097735005E+00
.16E+00 .115E+01        -.440382175418E+00
.16E+00 .120E+01        -.489881152313E+00
.16E+00 .125E+01        -.532697965534E+00
.16E+00 .130E+01        -.568941879292E+00
.16E+00 .135E+01        -.598726549515E+00
.16E+00 .140E+01        -.622168629750E+00
.16E+00 .145E+01        -.639386535697E+00
.16E+00 .150E+01        -.650499350788E+00
.24E+00 .500E+00        .105151509180E+01
.24E+00 .550E+00        .902927430831E+00
.24E+00 .600E+00        .760580266860E+00
.24E+00 .650E+00        .624715198146E+00
.24E+00 .700E+00        .495519756001E+00
.24E+00 .750E+00        .373134042775E+00
.24E+00 .800E+00        .257656748872E+00
.24E+00 .850E+00        .149150559410E+00
.24E+00 .900E+00        .476469867734E-01
.24E+00 .950E+00        -.468493232015E-01
.24E+00 .100E+01        -.134356760385E+00
.24E+00 .105E+01        -.214913344927E+00
.24E+00 .110E+01        -.288573700635E+00
.24E+00 .115E+01        -.355406364786E+00
.24E+00 .120E+01        -.415491396489E+00
.24E+00 .125E+01        -.468918249969E+00
.24E+00 .130E+01        -.515783883125E+00
.24E+00 .135E+01        -.556191075200E+00
.24E+00 .140E+01        -.590246930563E+00
.24E+00 .145E+01        -.618061548241E+00
.24E+00 .150E+01        -.639746839258E+00
.32E+00 .500E+00        .127124675148E+01
.32E+00 .550E+00        .111500201815E+01
.32E+00 .600E+00        .964607727216E+00
.32E+00 .650E+00        .820347369475E+00
.32E+00 .700E+00        .682447678179E+00
.32E+00 .750E+00        .551085208597E+00
.32E+00 .800E+00        .426392385902E+00
.32E+00 .850E+00        .308462995633E+00
.32E+00 .900E+00        .197357129692E+00
.32E+00 .950E+00        .931056208594E-01
.32E+00 .100E+01        -.428599223404E-02
.32E+00 .105E+01        -.948339252969E-01
.32E+00 .110E+01        -.178572990364E+00
.32E+00 .115E+01        -.255553779055E+00
.32E+00 .120E+01        -.325840150158E+00
.32E+00 .125E+01        -.389506988363E+00
.32E+00 .130E+01        -.446638204599E+00
.32E+00 .135E+01        -.497324951768E+00
.32E+00 .140E+01        -.541664032699E+00
.32E+00 .145E+01        -.579756479795E+00
.32E+00 .150E+01        -.611706288148E+00
.40E+00 .500E+00        .149832105248E+01
.40E+00 .550E+00        .133499863207E+01
.40E+00 .600E+00        .117712512374E+01
.40E+00 .650E+00        .102502405502E+01
.40E+00 .700E+00        .878960023174E+00
.40E+00 .750E+00        .739145108704E+00
.40E+00 .800E+00        .605744871487E+00
.40E+00 .850E+00        .478883861067E+00
.40E+00 .900E+00        .358650625882E+00
.40E+00 .950E+00        .245102236196E+00
.40E+00 .100E+01        .138268350928E+00
.40E+00 .105E+01        .381548654070E-01
.40E+00 .110E+01        -.552528211681E-01
.40E+00 .115E+01        -.141986880814E+00
.40E+00 .120E+01        -.222094439096E+00
.40E+00 .125E+01        -.295635232460E+00
.40E+00 .130E+01        -.362679511503E+00
.40E+00 .135E+01        -.423306164224E+00
.40E+00 .140E+01        -.477601036132E+00
.40E+00 .145E+01        -.525655426667E+00
.40E+00 .150E+01        -.567564743655E+00
.48E+00 .500E+00        .173189274038E+01
.48E+00 .550E+00        .156203457721E+01
.48E+00 .600E+00        .139721691821E+01
.48E+00 .650E+00        .123780100674E+01
.48E+00 .700E+00        .108408753268E+01
.48E+00 .750E+00        .936322772315E+00
.48E+00 .800E+00        .794704449054E+00
.48E+00 .850E+00        .659387198028E+00
.48E+00 .900E+00        .530487586840E+00
.48E+00 .950E+00        .408088685454E+00
.48E+00 .100E+01        .292244201230E+00
.48E+00 .105E+01        .182982206854E+00
.48E+00 .110E+01        .803084940354E-01
.48E+00 .115E+01        -.157904130516E-01
.48E+00 .120E+01        -.105344551621E+00
.48E+00 .125E+01        -.188398090610E+00
.48E+00 .130E+01        -.265007149319E+00
.48E+00 .135E+01        -.335237838904E+00
.48E+00 .140E+01        -.399164503887E+00
.48E+00 .145E+01        -.456868143302E+00
.48E+00 .150E+01        -.508434993278E+00
.56E+00 .500E+00        .197122178640E+01
.56E+00 .550E+00        .179532959950E+01
.56E+00 .600E+00        .162406711323E+01
.56E+00 .650E+00        .145783058271E+01
.56E+00 .700E+00        .129695464975E+01
.56E+00 .750E+00        .114171810545E+01
.56E+00 .800E+00        .992349533324E+00
.56E+00 .850E+00        .849032663329E+00
.56E+00 .900E+00        .711911352264E+00
.56E+00 .950E+00        .581094158922E+00
.56E+00 .100E+01        .456658513233E+00
.56E+00 .105E+01        .338654496139E+00
.56E+00 .110E+01        .227108255770E+00
.56E+00 .115E+01        .122025089193E+00
.56E+00 .120E+01        .233922196376E-01
.56E+00 .125E+01        -.688187019710E-01
.56E+00 .130E+01        -.154649344213E+00
.56E+00 .135E+01        -.234152666459E+00
.56E+00 .140E+01        -.307391091913E+00
.56E+00 .145E+01        -.374434862348E+00
.56E+00 .150E+01        -.435360556536E+00
.64E+00 .500E+00        .221566786369E+01
.64E+00 .550E+00        .203420113361E+01
.64E+00 .600E+00        .185695514362E+01
.64E+00 .650E+00        .168435816416E+01
.64E+00 .700E+00        .151677635240E+01
.64E+00 .750E+00        .135451904115E+01
.64E+00 .800E+00        .119784408667E+01
.64E+00 .850E+00        .104696304942E+01
.64E+00 .900E+00        .902046083802E+00
.64E+00 .950E+00        .763226477663E+00
.64E+00 .100E+01        .630604821954E+00
.64E+00 .105E+01        .504252814597E+00
.64E+00 .110E+01        .384216715546E+00
.64E+00 .115E+01        .270520476641E+00
.64E+00 .120E+01        .163168572400E+00
.64E+00 .125E+01        .621485581168E-01
.64E+00 .130E+01        -.325666193968E-01
.64E+00 .135E+01        -.121016534844E+00
.64E+00 .140E+01        -.203251399623E+00
.64E+00 .145E+01        -.279330359558E+00
.64E+00 .150E+01        -.349319957540E+00
.72E+00 .500E+00        .246468422266E+01
.72E+00 .550E+00        .227805897940E+01
.72E+00 .600E+00        .209525125084E+01
.72E+00 .650E+00        .191671812800E+01
.72E+00 .700E+00        .174285462878E+01
.72E+00 .750E+00        .157399842733E+01
.72E+00 .800E+00        .141043483523E+01
.72E+00 .850E+00        .125240175061E+01
.72E+00 .900E+00        .110009440963E+01
.72E+00 .950E+00        .953669851261E+00
.72E+00 .100E+01        .813251055249E+00
.72E+00 .105E+01        .678930742966E+00
.72E+00 .110E+01        .550774848504E+00
.72E+00 .115E+01        .428825676973E+00
.72E+00 .120E+01        .313104771740E+00
.72E+00 .125E+01        .203615514033E+00
.72E+00 .130E+01        .100345478241E+00
.72E+00 .135E+01        .326856518657E-02
.72E+00 .140E+01        -.876530659133E-01
.72E+00 .145E+01        -.172467247819E+00
.72E+00 .150E+01        -.251230220752E+00
.80E+00 .500E+00        .271781110947E+01
.80E+00 .550E+00        .252639950126E+01
.80E+00 .600E+00        .233841138686E+01
.80E+00 .650E+00        .215432937728E+01
.80E+00 .700E+00        .197457455665E+01
.80E+00 .750E+00        .179951057910E+01
.80E+00 .800E+00        .162944822055E+01
.80E+00 .850E+00        .146465004375E+01
.80E+00 .900E+00        .130533496765E+01
.80E+00 .950E+00        .115168262131E+01
.80E+00 .100E+01        .100383741991E+01
.80E+00 .105E+01        .861912337228E+00
.80E+00 .110E+01        .725992371111E+00
.80E+00 .115E+01        .596137711520E+00
.80E+00 .120E+01        .472386627914E+00
.80E+00 .125E+01        .354758095898E+00
.80E+00 .130E+01        .243254184181E+00
.80E+00 .135E+01        .137862222525E+00
.80E+00 .140E+01        .385567703264E-01
.80E+00 .145E+01        -.546985959345E-01
.80E+00 .150E+01        -.141949659709E+00
```

$k$值和$\delta$

```
k = 1 delta = .322090897364E+01
k = 2 delta = .465996003327E-02
k = 3 delta = .172117537914E-03
k = 4 delta = .330953429925E-05
k = 5 delta = .254137771997E-07
```

当$k=5$时，精度已经达到了要求，此时$p(x,y)$中的系数$c_{rs}$为

```
.202123044262E+01       -.366842636522E+01      .709247679136E+00       .848606392858E+00       -.415897940397E+00

.319191902005E+01       -.741167262380E+00      -.269700015696E+01      .163105207331E+01       -.484652918264E+00

.256783376068E+00       .158052371105E+01       -.464732264229E+00      -.799465014205E-01      .101380257369E+00

-.268881423675E+00      -.732402030864E+00      .108086081306E+01       -.811992184212E+00      .305416495777E+00

.216915251451E+00       -.175276128774E+00      -.791840695272E-01      .250488511538E+00       -.144991789392E+00
```

数表$\left(x_{i}^{*}, y_{j}^{*}, f\left(x_{i}^{*}, y_{j}^{*}\right), p\left(x_{i}^{*}, y_{j}^{*}\right)\right)$

```
.10E+00 .700E+00        .194720407918E+00       .194730357326E+00
.10E+00 .900E+00        -.183036970312E+00      -.183041838360E+00
.10E+00 .110E+01        -.445497629269E+00      -.445500042115E+00
.10E+00 .130E+01        -.597566705305E+00      -.597558856878E+00
.10E+00 .150E+01        -.646459593647E+00      -.646446111301E+00
.20E+00 .700E+00        .405979189288E+00       .405989539896E+00
.20E+00 .900E+00        -.225158150340E-01      -.225211162936E-01
.20E+00 .110E+01        -.338220789483E+00      -.338224022407E+00
.20E+00 .130E+01        -.544437827296E+00      -.544430450939E+00
.20E+00 .150E+01        -.647361337978E+00      -.647348010632E+00
.30E+00 .700E+00        .634777195151E+00       .634787453107E+00
.30E+00 .900E+00        .158801342082E+00       .158796295645E+00
.30E+00 .110E+01        -.207365658661E+00      -.207368580088E+00
.30E+00 .130E+01        -.465357900500E+00      -.465349923350E+00
.30E+00 .150E+01        -.620270952047E+00      -.620257138501E+00
.40E+00 .700E+00        .878960023174E+00       .878969865343E+00
.40E+00 .900E+00        .358650822218E+00       .358646043348E+00
.40E+00 .110E+01        -.552527776174E-01      -.552554368705E-01
.40E+00 .130E+01        -.362679502890E+00      -.362671062971E+00
.40E+00 .150E+01        -.567564742128E+00      -.567550582812E+00
.50E+00 .700E+00        .113661091016E+01       .113662035311E+01
.50E+00 .900E+00        .574980553226E+00       .574975843087E+00
.50E+00 .110E+01        .115992426843E+00       .115989321215E+00
.50E+00 .130E+01        -.238568293365E+00      -.238560419182E+00
.50E+00 .150E+01        -.491434391617E+00      -.491420900990E+00
.60E+00 .700E+00        .140604179891E+01       .140605068696E+01
.60E+00 .900E+00        .805941716346E+00       .805937302046E+00
.60E+00 .110E+01        .304429275827E+00       .304425831955E+00
.60E+00 .130E+01        -.950161177620E-01      -.950089457219E-01
.60E+00 .150E+01        -.393902305233E+00      -.393889837754E+00
.70E+00 .700E+00        .168578351531E+01       .168579121747E+01
.70E+00 .900E+00        .104988138137E+01       .104987773885E+01
.70E+00 .110E+01        .508293841773E+00       .508291045085E+00
.70E+00 .130E+01        .661488102960E-01       .661563554850E-01
.70E+00 .150E+01        -.276834338871E+00      -.276822042898E+00
.80E+00 .700E+00        .197457455665E+01       .197458126116E+01
.80E+00 .900E+00        .130533519966E+01       .130533200412E+01
.80E+00 .110E+01        .725992430530E+00       .725989310430E+00
.80E+00 .130E+01        .243254198540E+00       .243260790494E+00
.80E+00 .150E+01        -.141949656522E+00      -.141938789062E+00
```

  经过与他人的对比验证，可知结果正确。 

  此外，在Release模式下，无输出时进行时间测量，基本上在2000~3000微秒之间。

## 4. 讨论分析

  在本次程序设计中，主要面临的困难和思考有如下方面：

1. 步骤较多，需要仔细整理出合理的逻辑。
2. 对于牛顿迭代法的初值一开始没有很好的把握，一开始采用正太随机法生成初始向量，发现虽然能迭代收敛，但需要步数较多，有时可能要500步尚未迭代完毕。在参考了他人的思路之后，意识到题目中给出了$t,u$的大致范围，因此，可以为向量初始值设定为$(1,1,1,1)$，这样迭代次数便稳定下来，基本6次即可达到所需精度。
2. 如何在程序的高效性，可复用性，简洁性做平衡，是很困难的。通过反复的设计和抽象，使得我的代码水平有了进一步提升。